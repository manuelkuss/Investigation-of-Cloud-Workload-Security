"supported_platforms","technique","test_name","auto_generated_guid","url","part_of_final_test_set","c1","c2","c3","c4","c5","mfa_issue_1","mfa_issue_2","t1","t2","t3","t4","t5","t6","t7","c1_notes","c1_required_powershell_modules","c2_notes","c3_notes","c4_notes","c5_notes","c5_necessary_changes_to_atomics_for_CUT"
"azure-ad","T1136.003","Azure AD - Create a new user via Azure CLI","228c7498-be31-48e9-83b7-9cb906504ec8","https://www.atomicredteam.io/atomic-red-team/atomics/T1136.003#atomic-test-3---azure-ad---create-a-new-user-via-azure-cli ",1,,,,,,,,TRUE,,,,,,,,"Azure CLI","Replaces 'Azure AD - Create a new user'",,,,
"azure-ad","T1531","Azure AD - Delete user via Azure CLI","c955c1c7-3145-4a22-af2d-63eea0d967f0","https://www.atomicredteam.io/atomic-red-team/atomics/T1531#atomic-test-8---azure-ad---delete-user-via-azure-cli",1,,,,,,,,TRUE,,,,,,,,"Azure CLI","Replaces 'Azure AD - Delete user via Azure AD PowerShell'",,,,
"iaas:azure","T1526","Azure - Dump Subscription Data with MicroBurst","1e40bb1d-195e-401e-a86b-c192f55e005c","https://www.atomicredteam.io/atomic-red-team/atomics/T1526#atomic-test-1---azure---dump-subscription-data-with-microburst",1,,,,,,,TRUE,,,,,,TRUE,,,"Get-AzDomainInfo script, Az",,,,,"MFA compatibility: Use Connect-AzAccount command without credentials in order to interactively log in with MFA enabled"
"iaas:azure","T1619","Azure - Enumerate Azure Blobs with MicroBurst","3dab4bcc-667f-4459-aea7-4162dd2d6590","https://www.atomicredteam.io/atomic-red-team/atomics/T1619#atomic-test-4---azure---enumerate-azure-blobs-with-microburst",1,,,,,,,,,,,,TRUE,,,,"Invoke-EnumerateAzureBlobs",,,,,
"iaas:azure","T1098","Azure - adding user to Azure role in subscription","1a94b3fc-b080-450a-b3d8-6d9b57b472ea","https://www.atomicredteam.io/atomic-red-team/atomics/T1098#atomic-test-6---azure---adding-user-to-azure-role-in-subscription",1,,,,,,,TRUE,,TRUE,,,,,,,"Az.Resources","Replaces 'Azure AD - adding user to Azure AD role'. Difference to 'Azure AD - adding user to Azure AD role': In this test the user role is added for the scope of a defined subscription. New-AzRoleAssignment command is used for assigning Azure RBAC (Role-Based Access Control) roles to users, groups, service principals, or managed identities at various scopes within Azure resources.",,,,"MFA compatibility: Use Connect-AzAccount command without credentials in order to interactively log in with MFA enabled"
"iaas:azure","T1098","Azure - adding service principal to Azure role in subscription","c8f4bc29-a151-48da-b3be-4680af56f404","https://www.atomicredteam.io/atomic-red-team/atomics/T1098#atomic-test-7---azure---adding-service-principal-to-azure-role-in-subscription",1,,,,,,,TRUE,,TRUE,,,,,,,"Az.Resources","Replaces 'Azure AD - adding service principal to Azure AD role'",,,,"MFA compatibility: Use Connect-AzAccount command without credentials in order to interactively log in with MFA enabled"
"iaas:azure","T1078.004","Azure Persistence Automation Runbook Created or Modified","348f4d14-4bd3-4f6b-bd8a-61237f78b3ac","https://www.atomicredteam.io/atomic-red-team/atomics/T1078.004#atomic-test-2---azure-persistence-automation-runbook-created-or-modified",1,,,,,,,,,,TRUE,,,,,,"Terraform, Azure CLI, Azure",,,,,
"iaas:azure","T1619","Azure - Scan for Anonymous Access to Azure Storage (Powershell)","146af1f1-b74e-4aa7-9895-505eb559b4b0","https://www.atomicredteam.io/atomic-red-team/atomics/T1619#atomic-test-3---azure---scan-for-anonymous-access-to-azure-storage-powershell",1,,,,,,,,,,,,TRUE,,,,"None",,,,,
"azure-ad","T1552.005","Azure - Search Azure AD User Attributes for Passwords","ae9b2e3e-efa1-4483-86e2-fae529ab9fb6","https://www.atomicredteam.io/atomic-red-team/atomics/T1552.005#atomic-test-1---azure---search-azure-ad-user-attributes-for-passwords",0,1,,,,,,TRUE,,,,,,TRUE,,,"MSOnline",,,,,"MFA compatibility: Use Connect-MsolService command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1082","Azure Security Scan with SkyArk","26a18d3d-f8bc-486b-9a33-d6df5d78a594","https://www.atomicredteam.io/atomic-red-team/atomics/T1082#atomic-test-24---azure-security-scan-with-skyark ",0,1,,,,,,TRUE,,,,,,TRUE,,,"AzureAD, SkyArk AzureStealth, Az",,,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"iaas:azure","1555.006","Azure - Dump All Azure Key Vaults with Microburst","1b83cddb-eaa7-45aa-98a5-85fb0a8807ea","https://www.atomicredteam.io/atomic-red-team/atomics/T1555.006#atomic-test-1---azure---dump-all-azure-key-vaults-with-microburst",0,1,,,,,,TRUE,,,,,,TRUE,,"Uses deprecated and incompatible modules. Azure RM module is incompatible with other Azure modules!","Get-AzurePasswords script, AzureRM, Azure",,,,,"MFA compatibility: Use Connect-AzureRmAccount command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098","Azure AD - adding permission to application","94ea9cc3-81f9-4111-8dde-3fb54f36af4b","https://www.atomicredteam.io/atomic-red-team/atomics/T1098#atomic-test-8---azure-ad---adding-permission-to-application ",0,1,,,,,,TRUE,,,,,,,TRUE,,"AzureAD",,,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098.001","Azure AD Application Hijacking - Service Principal","b8e747c3-bdf7-4d71-bce2-f1df2a057406","https://www.atomicredteam.io/atomic-red-team/atomics/T1098.001#atomic-test-1---azure-ad-application-hijacking---service-principal ",0,1,,,,,,TRUE,,,,,,,TRUE,,"AzureAD","Does the same thing but differently than 'Azure AD Application Hijacking - App Registration'",,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098.001","Azure AD Application Hijacking - App Registration","a12b5531-acab-4618-a470-0dafb294a87a","https://www.atomicredteam.io/atomic-red-team/atomics/T1098.001#atomic-test-2---azure-ad-application-hijacking---app-registration ",0,1,,,,,,TRUE,,,,,,,TRUE,,"AzureAD","Does the same thing but differently than 'Azure AD Application Hijacking - Service Principal'",,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1484.002","Add Federation to Azure AD","8906c5d0-3ee5-4f63-897a-f6cafd3fdbb7","https://www.atomicredteam.io/atomic-red-team/atomics/T1484.002#atomic-test-1---add-federation-to-azure-ad",0,1,,,,,,TRUE,,,,,,,TRUE,,"AzureAD, AADInternals",,,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098.003","Simulate - Post BEC persistence via user password reset followed by user added to company administrator role","14f3af20-61f1-45b8-ad31-4637815f3f44","https://www.atomicredteam.io/atomic-red-team/atomics/T1098.003#atomic-test-2---simulate---post-bec-persistence-via-user-password-reset-followed-by-user-added-to-company-administrator-role ",0,1,,,,,,,,,,,,,TRUE,,"MSOnline, AzureAD",,,,,"MFA compatibility: Use Connect-MsolService command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098","Azure AD - adding user to Azure AD role","0e65ae27-5385-46b4-98ac-607a8ee82261","https://www.atomicredteam.io/atomic-red-team/atomics/T1098#atomic-test-4---azure-ad---adding-user-to-azure-ad-role",0,1,1,,,,,TRUE,,TRUE,,,,,,,"AzureAD","Replaced by 'Azure - adding user to Azure role in subscription'. Difference to 'Azure - adding user to Azure role in subscription': Add-AzureADDirectoryRoleMember is focused on directory roles within Microsoft Entra ID",,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098","Azure AD - adding service principal to Azure AD role","92c40b3f-c406-4d1f-8d2b-c039bf5009e4","https://www.atomicredteam.io/atomic-red-team/atomics/T1098#atomic-test-5---azure-ad---adding-service-principal-to-azure-ad-role ",0,1,1,,,,,TRUE,,TRUE,,,,,,,"AzureAD","Replaced by 'Azure - adding service principal to Azure role in subscription'",,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1098.003","Azure AD - Add Company Administrator Role to a user","4d77f913-56f5-4a14-b4b1-bf7bb24298ad","https://www.atomicredteam.io/atomic-red-team/atomics/T1098.003#atomic-test-1---azure-ad---add-company-administrator-role-to-a-user ",0,1,,,,,,TRUE,,TRUE,,,,,,,"MSOnline",,,,,"MFA compatibility: Use Connect-MsolService command without credentials in order to interactively log in with MFA enabled"
"azure-ad","T1110.001","Brute Force Credentials of single Azure AD user","5a51ef57-299e-4d62-8e11-2d440df55e69","https://www.atomicredteam.io/atomic-red-team/atomics/T1110.001#atomic-test-3---brute-force-credentials-of-single-azure-ad-user ",0,1,,,,TRUE,TRUE,,,,,TRUE,,,,,"AzureAD","In a MFA CUT this test does not make sense",,,"MFA issue 1: In a MFA CUT this test does not make sense",
"azure-ad","T1110.003","Password spray all Azure AD users with a single password","a8aa2d3e-1c52-4016-bc73-0f8854cfa80a","https://www.atomicredteam.io/atomic-red-team/atomics/T1110.003#atomic-test-4---password-spray-all-azure-ad-users-with-a-single-password ",0,1,,,,TRUE,TRUE,,,,,TRUE,,,,,"AzureAD","In a MFA CUT this test does not make sense",,,"MFA issue 1: In a MFA CUT this test does not make sense",
"azure-ad","T1136.003","Azure AD - Create a new user","e62d23ef-3153-4837-8625-fa4a3829134d","https://www.atomicredteam.io/atomic-red-team/atomics/T1136.003#atomic-test-2---azure-ad---create-a-new-user ",0,1,1,,,,,,TRUE,,,,,,,,"AzureAD","Replaced by 'Azure AD - Create a new user via Azure CLI'",,,,
"azure-ad","T1531","Azure AD - Delete user via Azure AD PowerShell","4f577511-dc1c-4045-bcb8-75d2457f01f4","https://www.atomicredteam.io/atomic-red-team/atomics/T1531#atomic-test-7---azure-ad---delete-user-via-azure-ad-powershell",0,1,1,,,,,,TRUE,,,,,,,,"AzureAD","Replaced by 'Azure AD - Delete user via Azure CLI'",,,,
"iaas:azure","T1562.008","Azure - Eventhub Deletion","5e09bed0-7d33-453b-9bf3-caea32bff719","https://www.atomicredteam.io/atomic-red-team/atomics/T1562.008#atomic-test-2---azure---eventhub-deletion",0,1,,,,,,TRUE,,,TRUE,,,,,,"AzureAD, Terraform",,,,,"MFA compatibility: Use Connect-AzureAD command without credentials in order to interactively log in with MFA enabled"
"iaas:azure","T1552.005","Azure - Dump Azure Instance Metadata from Virtual Machines","cc99e772-4e18-4f1f-b422-c5cdd1bfd7b7","https://www.atomicredteam.io/atomic-red-team/atomics/T1552.005#atomic-test-2---azure---dump-azure-instance-metadata-from-virtual-machines",0,,,TRUE,,,,,,,,,,TRUE,,,"None","The web request to the API is only possible within the VM.","The web request to the API is only possible within the VM.",,,
"azure-ad","T1606.002","Golden SAML","b16a03bc-1089-4dcc-ad98-30fe8f3a2b31","https://www.atomicredteam.io/atomic-red-team/atomics/T1606.002#atomic-test-1---golden-saml",0,,,,TRUE,,,,,,,,,,TRUE,,"AADInternals","Token signing certificate can be stolen in T1552.004. However, this test is dedicated to Windows and therefore not relevant for thise Azure cloud project",,"Not possible in test infrastructure, since no ADFS is used; Microsoft does not recommend ADFS, but PHS",,
"azure-ad","T1110.003","Password Spray Microsoft Online Accounts with MSOLSpray (Azure/O365)","f3a10056-0160-4785-8744-d9bd7c12dc39","https://www.atomicredteam.io/atomic-red-team/atomics/T1110.003#atomic-test-7---password-spray-microsoft-online-accounts-with-msolspray-azureo365 ",0,,,,,TRUE,TRUE,,,,,TRUE,,,,,"MSOLSpray","In a MFA CUT this test does not make sense",,,"MFA issue 1: In a MFA CUT this test does not make sense",
"iaas:azure","T1526","Azure - Enumerate common cloud services","58f57c8f-db14-4e62-a4d3-5aaf556755d7","https://www.atomicredteam.io/atomic-red-team/atomics/T1526#atomic-test-3---azure---enumerate-common-cloud-services",0,,,,,TRUE,TRUE,,,,,,,TRUE,,,"Az","The atomic test uses the AzureDiscovery.ps1 script that is in ths src directory. The script uses Connect-AzAccount in a way that is not possible with MFA enabled.",,,"MFA issue 1: In a MFA CUT this test does not make sense",
